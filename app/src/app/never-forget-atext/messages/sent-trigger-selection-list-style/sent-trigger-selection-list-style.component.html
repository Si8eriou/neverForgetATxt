<section id="page" class="mat-elevation-z4">
  <header class="center"
          *ngIf="contacts?.selectedOptions?.selected[0]?.value">
    <button mat-icon-button [matMenuTriggerFor]="contactMenu">
      <mat-icon>more_vert</mat-icon>
    </button>

    <span class="headerContactSelectedName">
      {{contacts?.selectedOptions?.selected[0]?.value?.fname}} {{contacts?.selectedOptions?.selected[0]?.value?.lname}}
    </span>

  </header>
  <nav class="center messagesHeader">
    <div>
      <mat-form-field>
        <mat-label>Search</mat-label>
        <input matInput class="form-control" type="text" name="search"
               autocomplete="off" placeholder="ex. pizza" disabled>
      </mat-form-field>
      <mat-icon>edit</mat-icon>
    </div>

    <mat-selection-list class="contactNames contact" [multiple]="false" #contacts>
      <mat-list-option *ngFor="let user of usersAndMessages" [value]="user" [selected]="true">
        {{user?.fname}} {{user?.lname}}
      </mat-list-option>
    </mat-selection-list>
  </nav>

  <main class="center">
    <div *ngFor="let sent_trigger of contacts?.selectedOptions?.selected[0]?.value?.sent_triggers">
      <mat-accordion>
        <mat-expansion-panel (opened)="panelOpenState = true"
                             (closed)="panelOpenState = false">
          <mat-expansion-panel-header>
            <mat-panel-title>{{sent_trigger?.event?.name}}</mat-panel-title>
            <mat-panel-description>
              {{fixDate(sent_trigger?.created_at)}}
            </mat-panel-description>
          </mat-expansion-panel-header>
          <p>{{sent_trigger?.event?.body}}</p>
        </mat-expansion-panel>
      </mat-accordion>
    </div>
  </main>
</section>


<mat-menu #contactMenu="matMenu">
  <button mat-menu-item>Edit Contact</button>
  <button mat-menu-item>Delete Messages</button>
</mat-menu>
